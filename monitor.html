<?php
require_once __DIR__ . '/includes/cache.php';
cluedo_send_html_no_cache_headers();
?>
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Supervision Cluedo</title>
  <link rel="stylesheet" href="<?= htmlspecialchars(cluedo_asset_url('./css/style.css'), ENT_QUOTES, "UTF-8") ?>"/>
<link rel="icon" href="<?= htmlspecialchars(cluedo_asset_url('./favicon.ico'), ENT_QUOTES, "UTF-8") ?>" type="image/x-icon"/>
</head>
<body>
  <div class="hub-app-version" data-app-version aria-label="Version applicative"></div>
  <div class="container monitor-page">
    <div class="monitor-header-row">
      <a class="monitor-hub-btn" href="./index.html">Retour au Hub</a>
      <button id="reset-history" class="monitor-reset-btn">Remettre l'historique Ã  zÃ©ro</button>
      <div class="monitor-endgame-group">
        <button id="toggle-end-game" class="monitor-endgame-btn">Fin de jeu</button>
        <p id="monitor-end-game-status" class="monitor-endgame-status" aria-live="polite"></p>
      </div>
    </div>

    <h1>ğŸ“Š Supervision terrain</h1>

    <section class="card monitor-sort-controls" aria-label="Tri des Ã©quipes">
      <label for="monitor-team-sort" class="admin-label">Ordre d'affichage des Ã©quipes</label>
      <select id="monitor-team-sort" class="admin-input">
        <option value="latest_message">DerniÃ¨re Ã©quipe ayant reÃ§u un message</option>
        <option value="longest_queue">Ã‰quipe dans la plus longue file d'attente</option>
        <option value="fewest_seen">Ã‰quipe ayant vu le moins de suspects</option>
        <option value="highest_avg_time">Ã‰quipe ayant le temps moyen par suspect le plus Ã©levÃ©</option>
      </select>
    </section>

    <section class="card monitor-message-controls" aria-label="Communication supervision">
      <h2>ğŸ’¬ Communication supervision</h2>
      <p class="monitor-message-intro">Un seul outil de messagerie : choisissez explicitement une cible, filtrez rapidement la liste, puis envoyez votre message.</p>

      <article class="monitor-message-panel" aria-label="Messagerie unifiÃ©e">
        <p class="monitor-muted">Les messages Ã©quipes restent visibles uniquement dans l'Espace Ã‰quipe ; les messages personnages restent visibles uniquement sur les pages personnage.</p>
        <div class="monitor-message-form-row">
          <label for="monitor-message-target-search" class="admin-label">Rechercher une cible</label>
          <input id="monitor-message-target-search" class="admin-input" type="search" placeholder="Filtrer Ã©quipes / personnages" autocomplete="off" spellcheck="false"/>
        </div>
        <div class="monitor-message-form-row">
          <label for="monitor-message-target" class="admin-label">Destinataire</label>
          <select id="monitor-message-target" class="admin-input" size="8"></select>
        </div>
        <div class="monitor-message-form-row">
          <label for="monitor-message-text" class="admin-label">Message</label>
          <textarea id="monitor-message-text" class="admin-input monitor-message-input" maxlength="300" placeholder="Ex: Fin du jeu dans 5 minutes."></textarea>
        </div>
        <button id="send-monitor-message" class="admin-button monitor-message-send-btn">Envoyer le message</button>
        <p id="monitor-message-feedback" class="team-feedback" aria-live="polite"></p>
      </article>
    </section>

    <section id="teams" class="monitor-grid" aria-live="polite">Chargementâ€¦</section>
  </div>
  <script src="<?= htmlspecialchars(cluedo_asset_url('./js/monitor.js'), ENT_QUOTES, "UTF-8") ?>"></script>
  <script src="<?= htmlspecialchars(cluedo_asset_url('./js/app-version.js'), ENT_QUOTES, "UTF-8") ?>" defer></script>
</body>
</html>
