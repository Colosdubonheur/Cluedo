<?php
require_once __DIR__ . '/includes/cache.php';
cluedo_send_html_no_cache_headers();
?>
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Supervision Cluedo</title>
  <link rel="stylesheet" href="<?= htmlspecialchars(cluedo_asset_url('./css/style.css'), ENT_QUOTES, "UTF-8") ?>"/>
<link rel="icon" href="<?= htmlspecialchars(cluedo_asset_url('./favicon.ico'), ENT_QUOTES, "UTF-8") ?>" type="image/x-icon"/>
</head>
<body>
  <div class="hub-app-version" data-app-version aria-label="Version applicative"></div>
  <a class="hub-return-link" href="./index.html">Retour au Hub</a>
  <div class="container monitor-page">
    <div class="monitor-header-row">
      <button id="reset-history" class="monitor-reset-btn">Remettre l'historique Ã  zÃ©ro</button>
      <button id="toggle-end-game" class="monitor-endgame-btn">Fin de jeu</button>
    </div>
    <p id="monitor-end-game-status" class="monitor-endgame-status" aria-live="polite"></p>

    <h1>ğŸ“Š Supervision terrain</h1>

    <section class="card monitor-message-controls" aria-label="Communication supervision">
      <h2>ğŸ’¬ Communication supervision</h2>
      <p class="monitor-message-intro">SÃ©lection explicite des destinataires : tout le monde, groupes complets ou cibles individuelles (Ã©quipes dâ€™abord, puis personnages).</p>

      <div class="monitor-message-panels">
        <article class="monitor-message-panel" aria-label="Messagerie Ã©quipes">
          <h3>ğŸ‘¥ Messagerie Ã©quipes</h3>
          <p class="monitor-muted">Visible uniquement dans l'Espace Ã‰quipe.</p>
          <div class="monitor-message-form-row">
            <label for="team-message-target" class="admin-label">Destinataires Ã©quipes</label>
            <select id="team-message-target" class="admin-input" multiple size="7"></select>
            <p class="monitor-muted">Maintenez Ctrl/Cmd pour multi-sÃ©lection.</p>
          </div>
          <div class="monitor-message-form-row">
            <label for="team-message-text" class="admin-label">Message Ã©quipe</label>
            <textarea id="team-message-text" class="admin-input monitor-message-input" maxlength="300" placeholder="Ex: Fin du jeu dans 5 minutes."></textarea>
          </div>
          <button id="send-team-message" class="admin-button monitor-message-send-btn">Envoyer aux Ã©quipes</button>
          <p id="team-message-feedback" class="team-feedback" aria-live="polite"></p>
        </article>

        <article class="monitor-message-panel" aria-label="Messagerie personnages">
          <h3>ğŸ­ Messagerie personnages</h3>
          <p class="monitor-muted">Visible uniquement sur la page personnage ciblÃ©e.</p>
          <div class="monitor-message-form-row">
            <label for="character-message-target" class="admin-label">Destinataires personnages</label>
            <select id="character-message-target" class="admin-input" multiple size="7"></select>
            <p class="monitor-muted">Maintenez Ctrl/Cmd pour multi-sÃ©lection.</p>
          </div>
          <div class="monitor-message-form-row">
            <label for="character-message-text" class="admin-label">Message personnage</label>
            <textarea id="character-message-text" class="admin-input monitor-message-input" maxlength="300" placeholder="Ex: Merci de prÃ©parer la rotation suivante."></textarea>
          </div>
          <button id="send-character-message" class="admin-button monitor-message-send-btn">Envoyer aux personnages</button>
          <p id="character-message-feedback" class="team-feedback" aria-live="polite"></p>
        </article>
      </div>
    </section>

    <section id="teams" class="monitor-grid" aria-live="polite">Chargementâ€¦</section>
  </div>
  <script src="<?= htmlspecialchars(cluedo_asset_url('./js/monitor.js'), ENT_QUOTES, "UTF-8") ?>"></script>
  <script src="<?= htmlspecialchars(cluedo_asset_url('./js/app-version.js'), ENT_QUOTES, "UTF-8") ?>" defer></script>
</body>
</html>
